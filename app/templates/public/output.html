<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <!-- Bootstrap CSS -->
    <link href="/static/resources/bootstrap/bootstrap-5.1.3-dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="/static/resources/bootstrap/bootstrap-5.1.3-dist/js/bootstrap.min.js">
    </script>
    <script src="/static/resources/custom/table_sort.js">
    </script>
    <style>
table td,
table th {
  border: 1px solid silver;
}
/* sort arrows from https://www.py4u.net/discuss/1061287*/ 
.headerSortDown:after,
.headerSortUp:after {
  content: ' ';
  position: relative;
  left: 2px;
  border: 8px solid transparent;
}

.headerSortDown:after {
  top: 10px;
  border-top-color: silver;
}

.headerSortUp:after {
  bottom: 15px;
  border-bottom-color: silver;
}

.headerSortDown,
.headerSortUp {
  padding-right: 10px;
}
      .stickit {
	position: relative;
	overflow: scroll;
	max-height: 15em;
        position            : relative;
        white-space         : nowrap;
      }
      .tableScroll {
	overflow: scroll;
        position            : relative;
        white-space         : nowrap;
      }
       .headcol2 {
        position            : sticky;
        width               : 100px;
        left                : 150px;
        background-color    : white !important;
      }
      .headcol {
        position            : sticky;
        min-width               : 150px;
	max-width: 		150px;
        left                : 0;
        background-color    : white !important;
      }
    </style>
    <title>
      Hello, world!
    </title>
  </head>
  <body>
    {% set user = 0 %}

	{% if args %}
		{% if args["user"] == "reviewer1" %}
			{% set user = 1 %}
		{% elif args["user"] == "reviewer2" %}
			{% set user = 2 %}
		{% elif args["user"] == "director" %}
			{% set user = 3 %}
		{%endif%}
	{% endif %}

	{% if user >= 1 %}
<div class="tableScroll">
      <table class="table table-striped" id="controlsTable">
        <tbody>
          <tr>
            <th class="headcol" onclick="sortTable('controlsTable','reviewControlsTable', 0)">
              Sample_Name
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 1)">
              Sample_ID
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 2)">
              SentrixBarcode_A
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 3)">
              SentrixPosition_A
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 4)">
              Sample_Plate
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 5)">
              Sample_Well
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 6)">
              Gender
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 7)">
              exclude
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 8)">
              Notes
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 9)">
              MISSING_CT
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 10)">
              OBS_CT
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 11)">
              F_MISS
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 12)">
              CALLRATE_THRESHOLD
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 13)">
              FAIL_CALLRATE
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 14)">
              DISCORDANCE_NUM
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 15)">
              DISCORDANCE_DEN
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 16)">
              CONCORDANCE_RATE
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 17)">
              CONCORDANCE_THRESHOLD
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 18)">
              FAIL_CONCORDANCE
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 19)">
              PEDSEX
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 20)">
              SNPSEX
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 21)">
              F_SEX
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 22)">
              SEXCHECK_THRESHOLD
            </th>
            <th onclick="sortTable('controlsTable','reviewControlsTable', 23)">
              FAIL_SEXCHECK
            </th>
         <tr>
            <td class="headcol">
              NA12751
            </td>
            <td>
              144
            </td>
            <td>
              201057050182
            </td>
            <td>
              R08C01
            </td>
            <td>
              WG4564689-DNA
            </td>
            <td>
              H12
            </td>
            <td>
              Female
            </td>
            <td>
              0
            </td>
            <td>
              validation_plate
            </td>
            <td>
              649481
            </td>
            <td>
              1839204
            </td>
            <td>
              0.646868
            </td>
            <td>
              0.985
            </td>
            <td>
              1
            </td>
            <td>
              144801
            </td>
            <td>
              1819984
            </td>
            <td>
              0.9205
            </td>
            <td>
              0.985
            </td>
            <td>
              1
            </td>
            <td>
              2
            </td>
            <td>
              2
            </td>
            <td>
              -1.063
            </td>
            <td>
              0.3
            </td>
            <td>
              0
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td class="headcol">
              HG00276
            </td>
            <td>
              192
            </td>
            <td>
              201057050102
            </td>
            <td>
              R03C01
            </td>
            <td>
              WG4564689-DNA
            </td>
            <td>
              C08
            </td>
            <td>
              Female
            </td>
            <td>
              0
            </td>
            <td>
              validation_plate
            </td>
            <td>
              628
            </td>
            <td>
              1839204
            </td>
            <td>
              0.999658548
            </td>
            <td>
              0.985
            </td>
            <td>
              0
            </td>
            <td>
              213865
            </td>
            <td>
              1819984
            </td>
            <td>
              0.8825
            </td>
            <td>
              0.985
            </td>
            <td>
              1
            </td>
            <td>
              2
            </td>
            <td>
              1
            </td>
            <td>
              0.8109
            </td>
            <td>
              0.3
            </td>
            <td>
              1
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td class="headcol">
              HG03124
            </td>
            <td>
              193
            </td>
            <td>
              201057050111
            </td>
            <td>
              R03C01
            </td>
            <td>
              WG4564689-DNA
            </td>
            <td>
              C09
            </td>
            <td>
              Male
            </td>
            <td>
              0
            </td>
            <td>
              validation_plate
            </td>
            <td>
              508
            </td>
            <td>
              1839204
            </td>
            <td>
              0.999723794
            </td>
            <td>
              0.985
            </td>
            <td>
              0
            </td>
            <td>
              219817
            </td>
            <td>
              1819984
            </td>
            <td>
              0.8793
            </td>
            <td>
              0.985
            </td>
            <td>
              1
            </td>
            <td>
              1
            </td>
            <td>
              2
            </td>
            <td>
              0.09339
            </td>
            <td>
              0.7
            </td>
            <td>
              1
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td class="headcol">
              HG01334
            </td>
            <td>
              224
            </td>
            <td>
              201057050039
            </td>
            <td>
              R06C01
            </td>
            <td>
              WG4564689-DNA
            </td>
            <td>
              F04
            </td>
            <td>
              Female
            </td>
            <td>
              0
            </td>
            <td>
              validation_plate
            </td>
            <td>
              1484
            </td>
            <td>
              1839204
            </td>
            <td>
              0.999193129
            </td>
            <td>
              0.985
            </td>
            <td>
              0
            </td>
            <td>
              214185
            </td>
            <td>
              1819984
            </td>
            <td>
              0.8824
            </td>
            <td>
              0.985
            </td>
            <td>
              1
            </td>
            <td>
              2
            </td>
            <td>
              2
            </td>
            <td>
              0.1228
            </td>
            <td>
              0.3
            </td>
            <td>
              0
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td class="headcol">
              HG02144
            </td>
            <td>
              225
            </td>
            <td>
              201057050075
            </td>
            <td>
              R06C01
            </td>
            <td>
              WG4564689-DNA
            </td>
            <td>
              F05
            </td>
            <td>
              Male
            </td>
            <td>
              0
            </td>
            <td>
              validation_plate
            </td>
            <td>
              583
            </td>
            <td>
              1839204
            </td>
            <td>
              0.999683015
            </td>
            <td>
              0.985
            </td>
            <td>
              0
            </td>
            <td>
              218148
            </td>
            <td>
              1819984
            </td>
            <td>
              0.8802
            </td>
            <td>
              0.985
            </td>
            <td>
              1
            </td>
            <td>
              1
            </td>
            <td>
              1
            </td>
            <td>
              0.8266
            </td>
            <td>
              0.7
            </td>
            <td>
              0
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td class="headcol">
              HG02947
            </td>
            <td>
              161
            </td>
            <td>
              201057050009
            </td>
            <td>
              R01C01
            </td>
            <td>
              WG4564689-DNA
            </td>
            <td>
              A01
            </td>
            <td>
              Male
            </td>
            <td>
              0
            </td>
            <td>
              validation_plate
            </td>
            <td>
              1017
            </td>
            <td>
              1839204
            </td>
            <td>
              0.999447043
            </td>
            <td>
              0.985
            </td>
            <td>
              0
            </td>
            <td>
              218708
            </td>
            <td>
              1819984
            </td>
            <td>
              0.8799
            </td>
            <td>
              0.985
            </td>
            <td>
              1
            </td>
            <td>
              1
            </td>
            <td>
              1
            </td>
            <td>
              0.8056
            </td>
            <td>
              0.7
            </td>
            <td>
              0
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <form action="/reviewer-submit" name="review_form" method="POST" id="review_form">
	    <div class=stickit>
      <table class="table table-striped" id="reviewControlsTable">
        <tbody>
	<tr>
	   <th class="headcol">
		   Sample_Name
	   </th>
           <th class="headcol2">
		   Sample_ID
	   </th>
		<th>
              REVIEWER1
            </th>
	    <th>
              REVIEWER1_COMMENTS
            </th>
            <th>
              REVIEWER2
            </th>
            <th>
              REVIEWER2_COMMENTS
            </th>
            <th>
              DIRECTOR
            </th>
            <th>
              DIRECTOR_COMMENTS
            </th>
          </tr>
		  {% for x in range(0,sname|length) %}
	  <tr>
		  <td class="headcol">
			  {{ sname[x] }}
		  </td>
		  <td class="headcol2">
			  {{ sid[x]  }}
            <td>
		    {% if user == 1 %}
				  <select form="review_form" class="form-select" name="approval1-{{ sid[x] }}">
					  <option value=0 {{ r1['none'][x] }}>Approve/Deny</option>
					  <option value=1 {{ r1['approve'][x] }}>Approve</option>
					  <option value = 2 {{ r1['deny'][x] }}>Deny</option>
				</select>
		{% else %}
			{% if r1['app'][x] == 0 %}
				<p> No Review Submitted </p>
			{% elif r1['app'][x] == 1 %}
				<p> Approved </p>
			{% elif r1['app'][x] == 2 %}
				<p> Denied </p>
			{% endif %}
  		{% endif %}
            </td>
            <td>
		    {% if user == 1 %}
		    <textarea class="form-control" form="review_form" name="comments1-{{ sid[x] }}" rows="3">{{ r1['com'][x] }} </textarea>
		    {% else %}
		    <p>{{ r1['com'][x] }}</p>
		    {% endif %}
            </td> 
	    <td>
		    {% if user == 2 %}
				  <select form="review_form" class="form-select" name="approval2-{{ sid[x] }}">
					  <option value=0 {{ r2['none'][x] }}>Approve/Deny</option>
					  <option value=1 {{ r2['approve'][x] }}>Approve</option>
					  <option value = 2 {{ r2['deny'][x] }}>Deny</option>
				</select>
		{% else %}
			{% if r2['app'][x] == 0 %}
				<p> No Review Submitted </p>
			{% elif r2['app'][x] == 1 %}
				<p> Approved </p>
			{% elif r2['app'][x] == 2 %}
				<p> Denied </p>
			{% endif %}
  		{% endif %}
            </td>
            <td>
		    {% if user == 2 %}
		    <textarea class="form-control" form="review_form" name="comments2-{{ sid[x]}}" rows="3"> {{ r2['com'][x] }}</textarea>
		    {% else %}
		    <p>{{ r2['com'][x] }}</p>
		    {% endif %}
            </td>
	    <td>
		    {% if user == 3 %}
				  <select form="review_form" class="form-select" name="approval3-{{ sid[x] }}">
					  <option value=0 {{ d['none'][x] }}>Approve/Deny</option>
					  <option value=1 {{ d['approve'][x] }}>Approve</option>
					  <option value = 2 {{ d['deny'][x] }}>Deny</option>
				</select>
		{% else %}
			{% if d['app'][x] == 0 %}
				<p> No Review Submitted </p>
			{% elif d['app'][x] == 1 %}
				<p> Approved </p>
			{% elif d['app'][x] == 2 %}
				<p> Denied </p>
			{% endif %}
  		{% endif %}
            </td>
            <td>
		    {% if user == 3 %}
		    <textarea form="review_form" class="form-control" name="comments3-{{ sid[x] }}" rows="3"> {{ d['com'][x] }}</textarea>
		    {% else %}
		    <p>{{ d['com'][x] }}</p>
		    {% endif %}
            </td>
	  </tr>
	  {% endfor %}
        </tbody>
      </table>
	</div>
	<div style="justify-content: center; display: flex; margin-top:1em;">
	<button form="review_form" type="submit" class="btn btn-primary">Submit Approvals for Controls Table</button>
	</div>
    </form>
      <div>
        {% else %}
        <h1>
          User {{ args["user"] }} Does Not Exist!
        </h1>
        {% endif %}
      </div>

  </body>
</html>
